TODO: develop cgi in the same way as http_gateway
